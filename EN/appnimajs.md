App/nima.JS
===========
Find out how to add soul to your apps with first LaaS in the world.

*Current version: [1.0.0]()*

To have appnima.js ready to work with you only have to set the value of the variable `Appnima.key` with the key that APP/NIMA provides you on the application creation:

    Appnima.key = "YOUR_KEY";

App/nima store user's session data in memory, so the session will persist in time.


Promises
--------
Appnima.js uses the promise pattern to handle each request, so to attach a callback (with error and result) to each request we have to do it using `.then` as it is shown in the following example:

```javascript
    Appnima.resource().then(function(error, result){
        if(error !== null){
            console.log("Error", error);
        }else{
            console.log("Success", result);
        }
    });
```

Error Handler
-------------
Appnima.js has the capability to centralize the error management in a method. To use this, just assign to Appnima.onError a callback function that will receive the generated error:

```javascript
    Appnima.onError = function(error){
        console.log("CODE: ", error.code);
        console.log("TYPE: ", error.type);
        console.log("MESSAGE: ", error.message);
    };
```

Token Management
----------------
App/nima uses a token to access the resources. When a token is expired the server will return a `480` error code, to refresh the token the method `Appnima.User.token()` must be called. It will do all the necessary transactions to update your token so you can continue working.

User
====
Basic
-----
#### Signup
To register a user in your application you only need to call the following method using as parameters the email, password and optionally a username:

    Appnima.User.signup (USER_MAIL, USER_PASSWORD);


#### Login
Login a user is as easy as calling the resource with the email and password:

    Appnima.User.login(USER_MAIL, USER_PASSWORD);


#### Logout
If you want to logout a user of your application as simple as calling the method *logout* without any parameter:

    Appnima.User.logout();


#### Information
Do you need all the data registered by a user? Just call this resource to get information:

    Appnima.User.info();

In addition, to obtain information of any user of App/nima, you only have to send the id of this user to the previous method:

    Appnima.User.info(USER_ID);


The object you will receive in both cases is:

```json
{
  "id"            : "USER_ID",
  "mail"          : "USER_MAIL",
  "username"      : "USER_NICKNAME",
  "name"          : "USER_NAME",
  "avatar"        : "http://USER_AVATAR_URL",
  "bio"           : "Founder & CTO at @tapquo",
  "phone"         : "PHONE_NUMBER",
  "token"         : "USER_TOKEN",
  "refresh_token" : "REFRESH_TOKEN"
}
```


#### Update
The `update` resource also allows users to update their data. To do this just call it using as parameter a dictionary that contains all this optional fields:

```coffeescript
  data =
    mail     : "USER_MAIL"
    username : "USER_NICKNAME"
    name     : "USER_NAME"
    avatar   : "http://AVATAR_URL"
    phone    : "USER_PHONE"
    site     : "http://tapquo.com",
    bio      : "USER_BIO"
  Appnima.User.update(data);
```

Password
--------
APP/NIMA offers its users two ways to deal passwords, remember it or change it.

#### Remember password
This action is in two steps:

    Appnima.User.rememberPassword(USER_MAIL, APPLICATION_ID, "http://DOMAIN_URL");

The first parameter is the user ```mail``` of APP/NIMA. The second parameter is the ID of application and the latter is the domain of the application that calls this function.

This function sends a mail to the user who owns the token from APP/NIMA with a URL as follows:
If you not send an url for domain:

    http://appnima.com/forgot/APPLICATION_ID?forgot_key=CODE

If you sent it:

    http://DOMAIN/forgot?forgot_key=CODE


The code is generated by APP/NIMA and serves to identify which user request asked to remember the password. For this, as you can see, it is necessary to generate an endpoint in the backend of the application with this URL where there is a form where you fill in the desired new password. So you have to call the following method:

    Appnima.User.resetPassword(REMEMBER_CODE, NEW_PASSWORD);

The first parameter is the URL code generated in the previous step and the second parameter is the new password that the user wants to regenerate. Once done, APP/NIMA sends an email telling user that the password has been changed.

In the case of not having application backend, APP/NIMA offers a view to regenerate the password to the user. This method should be called:

    Appnima.User.rememberPassword(USER_TOKEN);

Passing only the user's token you want to regenerate the password and APP/NIMA will send you an email with the URL where regenerating own password.

#### Change password
With this feature you can change your password directly. The only requirement is that the user is logged in with APP/NIMA, and then have to call the following method:

    Appnima.User.changePassword(OLD_PASSWORD, NEW_PASSWORD);

The first parameter is the old password and the second is the new password.

Terminal
--------

#### Register or Update
With this resource you can register or update the device the user is using to access the application. The request is done in the following way:

```coffeescript
    parameters =
        os      : "Android"
        type    : "Phone"
        token   : "TERMINAL_TOKEN"
        version : "4.1"
    Appnima.User.terminal(parameters);
```

The token is received from GCM services.

#### Info
Get the terminals that the user has used to access to the application using this resource:

    Appnima.User.teminal();

The data you will receive will be like:

```json
[
  {
    "id"      : "TERMINAL_ID",
    "type"    : "phone",
    "os"      : "ios",
    "token"   : "TERMINAL_TOKEN",
    "version" : "6.0"
  },
  {
    "id"      : "TERMINAL_ID"
    "type"    : "desktop",
    "os"      : "macos",
    "token"   : "TERMINAL_TOKEN",
    "version" : "10.8"
  }
]
```


Subscription
------------
If you need it, you can ask users to register their emails to get an invitation to the app. Just call the resource using the email as parameter:

    Appnima.User.subscribe(USER_MAIL);


Tickets
-------
Use this resource as ticket managing system to resolve incidences or attend consults from users. The request requires an object as follows:

```coffeescript
  parameters =
    title       : "[QUESTION]: How can I do this?"
    description : "Lorem ipsum dolor sit amet, consectetur adipisicing elit"
    reference   : "REFERENCE_ID"
    type        : "2"
```

The reference field is used if you want to add the ID of any other model, either APPNIMA or another database .
The type field can be 0, 1 or 2. If this field is not sent, the default is 0 .

**0** - > "question"
**1** - > " bug"
**2** -> "support"

    Appnima.User.ticket(parameters);
    
On the other hand, if you modify a ticket you have two options :

The first would be to change the ticket. This is only possible when the ticket is not responded . To do this you just have to send the same data to create when adding the ID of the ticket to be modified .

The other option is to answer a ticket. This would have to send the following criteria:

```coffeescripnt
  parameters =
    response: "Lorem ipsum"
```

Once replied to ticket, an email is sent to the creator of that ticket.
In both cases you have to send the data to the following call:

    Appnima.User.updateTicket(parameters);

If you want to get a ticket in particular, would have to send the ID of the ticket to the next call of AppnimaJS :

``` coffeescript
  parameters = id: TICKET_ID
```

    Appnima.User.getTicket(parameters);

There is also the option of finding a set of tickets. This would send the following parameters:

``` coffeescript
  parameters =
    reference : REFERENCE_ID
    type      : 0
    solved    : true
    user      : USER_ID
```

The above example would be the option to send all possible parameters . The `solved` attribute can be `true` or `false` o can not be shipped. If sent like `true`, you would like answered tickets. If you send like `false` you would like tickets that not answered, and if that attribute is not sent it is because you want to get any ticket, whether answered or not. Any of the attributes of the object could not be sent.

This call needs to be done to find the tickets would be:

    Appnima.User.searchTickets(parameters);

You can use pagination sended this parameters:

``` coffeescript
  parameters =
    reference   : REFERENCE_ID
    type        : 0
    solved      : true
    user        : USER_ID
    num_results : 10
    page        : 1
```
Is the same method like in post pagination but there not send "last_data" attribute.

You also can remove tickets with the following method.

    Appnima.User.deleteTicket(TICKET_ID);

Messenger
=========

Mail
----
Your application's users can send emails to other users using this resource. To do this, you may to send an object with this parameters: receiver's ID, the subject and the email body:

  parameters =
    user    : USER_ID
    subject : "Meeting"
    message : "Tomorrow morning."

  Appnima.Messenger.mail(parameters);

SMS
---
APP/NIMA also provides a SMS service. To use this resource you may to send an object with  the receivers ID and the message:

  parameters =
    user    : USER_ID
    message : "Remember that your appointment is tomorrow."

  Appnima.Messenger.sms(parameters);

Messages
--------
#### Private messages
To use the APP/NIMA's private message service just call the resource sending an object with the following parameters: Receiver's ID, message body and optionally the subject:

  parameters =
    user    : USER_ID
    subject : "Where are you?"
    message : "Where are you? I'm at home waiting for you."

  Appnima.Messenger.message(parameters);


#### Inbox
You can get the unread messages you have received by just calling this resource:

    Appnima.Messenger.messageInbox();

#### Outbox
As we do with received messages we can get the list of of sent messages, just use this resource:

    Appnima.Messenger.messageOutbox();

#### Conversation
For to get message exchanged with another user, both received as sent, is used this method, which receives as parameter the username of another user.

    Appnima.Messenger.conversation(USER_NICKNAME);

#### Mark as read
To mark a message as read call this resource using the message id as parameter:

    Appnima.Messenger.readMessage(MESSAGE_ID);

#### Summary
This method allows you to obtain a list containing the last message you've sent or received by each user.

    Appnima.Messenger.summary();

#### Search
You can do a search from your messages sent and received across a word that contain both the message subject such the message's body.

    Appnima.Messenger.search("node");

#### Delete message
To delete a message cal this resource using the message id as parameter:

    Appnima.Messenger.deleteMessage(MESSAGE_ID);


Relathionships
==============

#### Search
Find people on your application. Sends any string for mail or username attribute to search:

    Appnima.Network.search(USER_NICKNAME/USER_MAIL);

The server returns `200 Ok` and the list that contains the query:

```json
[
  {
    "avatar"   : "http://appnima.com/img/avatar.jpg",
    "id"       : "USER_ID",
    "name"     : "USER_NAME",
    "username" : "USER_NICKNAME"
  },
  {
    "avatar"   : "http://appnima.com/img/avatar.jpg",
    "id"       : "USER_ID",
    "name"     : "USER_NAME",
    "username" : "USER_NICKNAME"
  },
  {
    "avatar"   : "http://appnima.com/img/avatar.jpg",
    "id"       : "USER_ID",
    "name"     : "null",
    "username" : "USER_NICKNAME"
  }
]
```

#### Follow
You can follow a user using this resource, call this resource using the user to follow's id as parameter:

  Appnima.Network.follow(USER_ID);


#### Follow shield
You can do shield follow with this resource. This means that user that you send and you are going to be follower and following.

  Appnima.Network.shieldFollow(USER_ID);


#### Unfollow
You can unfollow a user using this resource, call this resource using the user to unfollow's id as parameter:

  Appnima.Network.unfollow(USER_ID);


#### Following
With this resource you can get the list of people that a user is following. It works as the previous parameter, accepting an optional user id parameter:

  Appnima.Network.following();

  Appnima.Network.following({user: USER_ID});

On the other hand, there is also the option for you to return the list with pagination, that is, that in each API call returning part of the list of users. This should be sent only two variables along with the user id:

  parameters =
    user        : USER_ID
    page        : 0
    num_results : 5

  Appnima.Network.following(parameters);

The first variable is the page number you want to obtain, that is, the part of the list you want to get. Second number is the number of results you want to obtain. In the first call, this variable will be multiplied by 2, and in other cases, this variable is the same.

#### Followers
With this resource you can get the list of people that follow a user. It works as the previous parameter, accepting an optional user id parameter:

  Appnima.Network.followers();

  Appnima.Network.followers({user: USER_ID});

Like as explained above, it is also possible to obtain results with pagination. The mode of this is the same as getting the users you follow.

In this case, the call returns one more variable in each object. This variable indicate that user is loggued is follow or not that user.

#### Friends
You can also obtain the session's friends, a friend is considered the user having a reinforced relationship (follower / following)

  Appnima.Network.friends();

The server returns `200 Ok` and the next object:
```json
[
  {
    "avatar"   : "http://AVATAR_URL",
    "id"       : "USER_ID",
    "mail"     : "USER_MAIL",
    "name"     : "USER_NAME",
    "username" : "USER_NICKNAME"
  }
]
```


#### Check
With this resource yoa can get information about logged user's realtionship with other user, if I am following him and if he is my follower:

  Appnima.Network.check(USER_ID);

The server returns `200 Ok` and the next object:

```json
{
  "following" : "true",
  "follower"  : "false"
}
```

Posts
--------
#### Create
Users can create posts within an application. For this they have to send the following object with wants parameters with the request:

  parameters =
    title   : "Lorem Ipsum",
    content : "Lorem ipsum dolor sit amet, consectetur adipisicing elit.",
    image   : "http://IMAGE_URL"

  Appnima.Network.Post.create(parameters);

Only ```content``` parameter is required. An example of how to create a ```post``` with only content is the following.

  Appnima.Network.Post.create({content: "Lorem Ipsum"});

This call will return an object with information on the new post:

```json
  "post":
    {
      "id"      : "POST_ID",
      "content" : "Lorem Ipsum",
      "image"   : "http://IMAGE_URL",
      "owner"   :
        {
          "id"       : "OWNER_ID",
          "name"     : "OWNER_NAME",
          "username" : "OWNER_NICKNAME",
          "avatar"   : "http://AVATAR_URL"
        },
      "comments"   : [],
      "likes"      : [],
      "is_liked"   : "false",
      "created_at" : "CREATED_AT"
    }
```

#### Update
The user can update created post. To do this, user must send the following parameters:

  parameters =
    id      : "POST_ID",
    content : "Lorem Ipsum update content",
    title   : "Lorem Ipsum update title",
    image   : "http://IMAGE_URL"

    Appnima.Network.Post.update(parameters);

Not required to send the data that will not be modified. Two examples of this would be:

  parameters =
    id      : "POST_ID",
    content : "Lorem Ipsum 2",
    image   : "http://IMAGE_URL2"

  Appnima.Network.Post.update(parameters);

  parameters =
    id      : "POST_ID",
    content : "Lorem Ipsum 1",
    title   : "Lorem ipsum 2"

  Appnima.Network.Post.update(parameters);

As can be seen, in the first case, you want to change the content and the image but not the title, so you must send that field to null.

In the second case, you want to change the content and the title and image as the last parameter is not necessary to pass null. The same would happen in the following case:

  parameters =
    id      : "POST_ID",
        content : "Lorem ipsum new"

  Appnima.Network.Post.update(parameters);

In this case you only want to modify the content and therefore, other variables that go behind would not need to send in null.

This method returns ```message:" Ok "``` if all went well.

#### Delete
The user can delete created post.
El usuario que ha creado un post puede borrarlo. To do this only has to send the id of the post to be deleted:

    Appnima.Network.Post.remove(POST_ID);

As in the previous method, if all went well return a message ```message: "Ok"```

#### Get a post
The user can get the information of a concrete post sending ```id``` of that post.


    Appnima.Network.Post.get(POST_ID);

This call return following data:

```json
  "post":
    {
      "id"      : "POST_ID",
      "content" : "Lorem Ipsum",
      "image"   : "http://IMAGE_URL",
      "owner"   :
        {
          "id"       : "OWNER_ID",
          "name"     : "OWNER_NAME",
          "username" : "OWNER_NICKNAME",
          "avatar"   : "http://AVATAR_URL"
        },
      "comments":
        [
          {
            "id"         : "COMMENT_ID",
            "content"    : "Comment 1",
            "created_at" : "CREATED_AT",
            "owner"      :
              {
                "avatar"   : "http://AVATAR_URL",
                "id"       : "OWNER_ID",
                "name"     : "OWNER_NAME",
                "username" : "OWNER_NICKNAME"
              }
          }
        ],
      "likes":
        [
          {
            "avatar"   : "http://AVATAR_URL",
            "id"       : "USER_ID",
            "name"     : "USER_NAME",
            "username" : "USER_NICKNAME"
          },
          {
            "avatar"   : "http://AVATAR_URL",
            "id"       : "USER_ID",
            "name"     : "USER_NAME",
            "username" : "USER_NICKNAME"
          },
        ],
      "is_liked"   : "false",
      "created_at" : "CREATED_AT"
    }
```

The list of likes are users who have made like this post.

#### Search
The user can search for a particular post by the text of its content, or if it sends just a word, it will return all posts that contain that word in their content.

  parameters =
    query       : "lorem",
    page        : 1,
    num_results : 12,
    last_data   : LAST_DATA

  Appnima.Network.Post.search(parameters);

As can be seen, in this case the results are to be obtained by pagination, as explained above. But if it does not wish to use it, you simply have to make the call as follows:

  Appnima.Network.Post.search({query: "Lorem"});

In this case, both methods return an array of the post has been found, or an empty array if none match.

#### Counter
This method is used to obtain the counter of post that user created. The answer is ```posts_count:8 ```. In this example, the user of the session would have created eight post.

  Appnima.Network.Post.counter();
  Appnima.Network.Post.counter(USER_ID);

If user sends an user id, method return counter of that user.

#### Timeline
This method is used to obtain a list of post. There would be two different ways of creating two different results. A case would be:

  parameters =
    page        : page,
    num_results : 12,
    last_data   : LAST_DATA

  Appnima.Network.Post.timeline();
  Appnima.Network.Post.timeline(parameters);

In this case, the first call would get the ```timeline``` of session user. This is a list of post that user created and those who user follow. (Easy example to understand is the timeline of ```Twitter```).

In second call is the same, only to be get posts by pagination.
The other case would be:

  Appnima.Network.Post.timeline({username: "my_username"});

  parameters =
    username    : USER_NICKNAME,
    page        : 1,
    num_results : 12,
    last_data   : LAST_DATA

  Appnima.Network.Post.timeline(parameters);

In this case you are getting the timeline of a specific user, the post he has written. (Next to the example of Twitter, this case would be when you enter in to the profile of a particular user). As you can see, you can also do by pagination.

#### Create comment
Posts may have comments, and with this call user can do comments.

  parameters =
    id      : POST_ID,
    content : "Este es mi comentario"

  Appnima.Network.Post.createComment(parameters);

Call returns ```message: "Ok"```.

#### Update comment
User can update its comment.

    parameters =
        id      : "COMMENT_ID",
        content : "Este es mi comentario modificado",
        title   : "Este es el título modificado."

    Appnima.Network.Post.updateComment(parameters);

Call returns ```message: "Ok"```.


#### Delete comment
The user who created a comment can delete his comments with following method sending comment ```id```:

    Appnima.Network.Post.deleteComment(COMMENT_ID);

Call returns ```message: "Ok"```.

#### Get comment
To obtain all comments of post the user may to call this method sending ```id```of post:

    Appnima.Network.Post.comments(POST_ID);

This call return following array of objects:

```json
  "comments":
    [
      {
        "id"         : "COMMENT_ID",
        "content"    : "Comment 1",
        "created_at" : "CREATED_AT",
        "owner":
          {
            "avatar"   : "http://AVATAR_URL",
            "id"       : "OWNER_ID",
            "name"     : "OWNER_NAME",
            "username" : "OWNER_NICKNAME"
          }
      },
      {
        "id"         : "COMMENT_ID",
        "content"    : "Comment 2",
        "created_at" : "CREATED_AT",
        "owner":
          {
            "avatar"   : "http://AVATAR_URL",
            "id"       : "OWNER_ID",
            "name"     : "OWNER_NAME",
            "username" : "OWNER_NICKNAME"
          }
      }
    ]
```

#### Do like post
The user can do favorite a concret post, or remove that "like". For this, the user must send the id of the post along with the call:

  Appnima.Network.Post.like(POST_ID);

If it is the first time that user do like a post, this will be created, but on the contrary, if this post already has favorite, the favorite will disappear and the next time this method is called again to be favorite.
If all went well return ```message:" Successful "```.

#### Get users who have made a post favorite
If the user wants to get all users who have a favorite post in particular, you simply send the id of the post along with the following call:

  Appnima.Network.Post.likeUsers(POST_ID);

This method return following data:

```json
  "users":
    [
      {
        "id"       : "USER_ID",
        "name"     : "USER_NAME",
        "username" : "USER_NICKNAME",
        "avatar"   : "http://AVATAR_URL",
        "bio"      : "USER_BIO"
      }
    ]
```

#### Get all favorite posts from an user
If you want to get the favorite post of user, you want to do this method sending user username:

  Appnima.Network.Post.userLike({username: USER_NICKNAME});

The API will return a list of post, which are favorites for the username's user.

They can also be obtained by pagination:

  parameters =
    username    : USER_NICKNAME,
    page        : 1,
    num_results : 12,
    last_data   : LAST_DATA

  Appnima.Network.Post.userLike(parameters);

Location
========
Places
------
#### Search
Using the users latitude and longitude or any point you can get the nearest places such as museums, restaurants, public buildings… You also can provide a search radius or precision to get a more accurate search. To do this use this respource  with the latitude, longitude and radius/precision. The precision is a numeric value ( 0,1 or 2) and the radius is a numeric value in meters:

  parameters =
    latitude  : 3.1667
    longitude : 101.7
    precision : 2

  Appnima.Location.places(parameters);

  parameters =
    latitude  : 3.1667
    longitude : 101.7
    radius    : 15

  Appnima.Location.places(parameters);


#### Info
Get detailed information from a place using this resource. Send the `ID` and `REFERENCE` with the request:

  Appnima.Location.place(place_id: PLACE_ID );


#### Add
In APP/NIMA you can add a place and add relevant information such as name, address, phone number… To do this yo have to use this resource with the following parameters: Name, address, locality, Postal Code, Country, latitude and longitude:

  place =
    name        : "Tapquo S.L."
    address     : "C/ Ibañez de Bilbao 28 8º"
    locality    : "Bilbao"
    postal_code : POST_CODE
    country     : "España"
    latitude    : 43.2658947
    longitude   : -2.925888299999997
    mail        : "hello@tapquo.com"
    phone       : "609326913"
    webiste     : "http://tapquo.com"

  Appnima.Location.add(place);

Optionally you can add email, phone and web site data.


#### Checkins
You users can register the places where they are. Send the `ID` and `REFERENCE` with the request:

  Appnima.Location.checkin(PLACE_ID);

You can get the list of checkins with this resource. The unique parameter needed is the user's id:

  Appnima.Location.checkins(USER_ID);


People
------
#### Friends around
You can ask APP/NIMA for the friends that are near to you. The parameters needed are the latitude, longitude and radius:

  parameters =
    latitude  : 43.6525842
    longitude : -79.3834173
    radius    : 1000

  Appnima.Location.friends(parameters);

#### People around
You can ask APP/NIMA for the people that is near to you. The parameters needed are the latitude, longitude and radius:

  parameters =
    latitude  : 43.6525842
    longitude : -79.3834173
    radius    : 1000

  Appnima.Location.people(parameters);

#### User
You can change your location with APP/NIMA. The parameters needed are the latitude and the longitude:

  parameters =
    latitude  : 43.6525842
    longitude : -79.3834173

  Appnima.Location.user(parameters)

And if you can know what is your current position, only do the previous call without parameters.

  Appnima.Location.user()

Push
====
To send push notifications to the devices that the users have registered the data needed is: User's ID, the notification text, and the content of the notification.

  Appnima.Push.send(USER_ID, "Mensaje", {"title": "JSON con los campos necesarios", "text": "Hola App/nima!"});

Calendar
==========

#### Create

APP/NIMA allows users to have a calendars system where you can manage your events.

To create a new calendar, you need to sent an object with the name and color of the new calendar:

  parameters =
    name  : "mi calendario",
    color : "#FF66CC"


  Appnima.Calendar.create(parameters)

This function returns the new calendar:

```json
  "calendar":
    {
      "id"         : "CALENDAR_ID",
      "name"       : "Mi calendario",
      "color"      : "#FF66CC",
      "created_at" : "Tue Feb 04 2014 13:19:06 GMT+0100 (CET)",
      "owner"      :
        {
          "id"       : "OWNER_ID",
          "username" : "OWNER_NICKNAME",
          "mail"     : "OWNER_MAIL",
          "avatar"   : "http://appnima.com/img/avatar.jpg",
          "name"     : "OWNER_NAME"
        },
      "shared": []
    }
```

#### Update

We also have the option to change the name and color of a calendar already created. You have to send the "id" of the calendar, the new name and the new color.

  parameters =
    id    : CALENDAR_ID,
    name  : "mi nuevo nombre de calendario",
    color : "#FF33CC"

  Appnima.Calendar.update(parameters)

If the calendar does not exist, it returns a 404 error, If on the contrary exists, returns the calendar with the changed fields:

```json
  "calendar":
    {
      "id"         : "CALENDAR_ID",
      "name"       : "Mi nuevo calendario",
      "color"      : "#FF66CC",
      "created_at" : "Tue Feb 04 2014 13:19:06 GMT+0100 (CET)",
      "owner":
        {
          "id"       : "USER_ID",
          "username" : "USER_NICKNAME",
          "mail"     : "USER_MAIL",
          "avatar"   : "http://appnima.com/img/avatar.jpg",
          "name"     : "USER_NAME"
        },
      "shared": []
    }
```

#### Shared

It is possible to share a calendar with other users, so that they too can see the events that are in that calendar.

To do this, you must send as parameter the id of calendar, the id of the user to invite, and "add";

  parameters =
    id      : "CALEDNAR_ID",
    profile : "USER_ID",
    state   : "add"

  Appnima.Calendar.shared(parameters)

Or on the contrary, you can also remove a user from the list of shared users, so that the user no longer see such events. For this, the function call is the same as the share, only that third paramentro is "remove":

  parameters =
    id      : "CALENDAR_ID",
    profile : "USER_ID",
    state   : "remove"

  Appnima.Calendar.shared(parameters)

If the calendar does not exist, it returns a 404 error. If you have not been errors return the updated calendar. The "shared" attribute corresponds to the list of users who have shared their calendar.

```json
  "calendar":
    {
      "id"         : "CALENDAR_ID",
      "name"       : "Mi nuevo calendario",
      "color"      : "#FF66CC",
      "created_at" : "Tue Feb 04 2014 13:19:06 GMT+0100 (CET)",
      "owner":
        {
          "id"       : "USER_ID",
          "username" : "USER_NICKNAME",
          "mail"     : "USER_MAIL",
          "avatar"   : "http://appnima.com/img/avatar.jpg",
          "name"     : "USER_NAME"
        },
      "shared": ["USER_ID"]
    }
```

#### List
APP/NIMA gives us the option to get all the calendars that the user owns, and those who have shared. To do this, simply run the following function:

    Appnima.Calendar.list()

Returns an array of calendars:

```json
  "calendar":
    [
      {
        "id"         : "CALENDAR_ID",
        "name"       : "Mi nuevo calendario",
        "color"      : "#FF66CC",
        "created_at" : "Tue Feb 04 2014 13:19:06 GMT+0100 (CET)",
        "owner":
          {
            "id"       : "USER_ID",
            "username" : "USER_NICKNAME",
            "mail"     : "USER_MAIL",
            "avatar"   : "http://appnima.com/img/avatar.jpg",
            "name"     : "USER_NAME"
          },
        "shared": ["USER_ID"]
      }
    ]
```

#### Borrar
Also allowed to delete a calendar, at the same time all your events are removed. To do this, you must send the "id" calendar to be deleted

  Appnima.Calendar.remove(CALENDAR_ID)

If the calendar does not exist, it returns a 404 error. If it goes well, it returns a success message.

  {message: Successful}

#### Activity
APP/NIMA also provides us information on what has happened in a calendar. If we use the function shown below sending as a parameter the "id" of a calendar, provides a list of activities that have happened in it, such as: to update calendar, to create, modify or delete an event belonging to the calendar, share your calendar or delete someone from the list of shared users, invite someone to take the guest list, or the confirm to  assistance to a event.

  Appnima.Calendar.activityCalendar(CALENDAR_ID)

If the calendar does not exist, it returns a 404 error. If it went well, it returns a list of activities with the structure shown below

```json
  "activities":
    [
      {
        "id"         : "ACTIVITY_ID",
        "message"    : "User has created the event",
        "created_at" : "Mon Feb 10 2014 16:25:54 GMT+0100 (CET)",
        "profile"    :
          {
            "username" : "USER_NICKNAME",
            "name"     : "USER_NAME",
            "mail"     : "USER_MAIL",
            "avatar"   : "http://appnima.com/img/avatar.jpg",
            "id"       : "USER_ID"
          },
        "event":
          {
            "id"          : "EVENT_ID",
            "calendar"    : "CALENDAR_ID",
                        "date_init"   : "Mon Apr 14 2014 09:00:00 GMT+0200 (CEST)",
                "date_finish" : "Mon Apr 14 2014 11:00:00 GMT+0200 (CEST)",
                      "name"        : "BilboStack updated",
                      "description" : "This event is bilboStack",
                      "place"       : "PLACE_ID",
                      "assistents"  : [ "USER_ID" ],
                        "created_at"  : "Mon Feb 10 2014 16:25:54 GMT+0100 (CET)",
                        "tags"        : [ "learn" ],
                        "guest"       : [ "USER_ID_1", "USER_ID_2" ]
                  },
              "calendar":
                {
                      "id"         : "CALENDAR_ID",
                        "name"       : "Mi calendario updated",
                      "color"      : "#FA58F4",
                        "created_at" : "Mon Feb 10 2014 16:25:54 GMT+0100 (CET)",
                        "owner"      : "OWNER_ID",
                        "shared"     : []
                    },
              "owner":
                {
                      "id"       : "OWNER_ID",
                      "username" : "OWNER_NICKNAME",
                        "mail"     : "OWNER_MAIL",
                        "avatar"   : "http://appnima.com/img/avatar.jpg",
                        "name"     : "OWNER_NAME"
                    }
            }
    ]
```

The event and calendar is where the activity was performed. If the event is null, is that only affects the calendar. The field "owner" is the person performing the activity and the "profile" field is the person who is targeted the activity.

#### Create event

Through the following function can create an event to a calendar. Should be sent as a parameter an object that contains the following parameters: the "id" of calendar to will belong to the new event , the event name , description, start and end date format mm-dd-yyyy hh:mm mm a string with a list of "id" separated "," corresponding to the users you want to share this event, a string with a list separated by ", " event to taguear tags , users address at which to hold the event , location, country, latitude and longitude:

```coffeescript
  data =
    calendar    : CALENDAR_ID
    name        : "partido de futbol"
    description : "quedada para jugar un partido de fútbol"
    init        : "04-14-2014 09:00"
    finish      : "04-14-2014 11:00"
    address     : "c/ San Mames"
    locality    : Bilbao
    country     : "España"
    latitude    : "23.23"
    longitude   : "-2.29"
    guest       : null
    tags        : "futbol,deporte"
  Appnima.Calendar.event(data)
```

This function returns the new event:

```json
  "event":
    {
          "id"          : "EVENT_ID",
          "calendar"    : "CALENDAR_ID",
            "date_init"   : "Mon Apr 14 2014 09:00:00 GMT+0200 (CEST)",
          "date_finish" : "Mon Apr 14 2014 11:00:00 GMT+0200 (CEST)",
          "description" : "Quedada para jugar un partido de fútbol",
            "name"        : "Partido de fútbol",
            "place":
              {
                    "address"    : "c/ San Mames",
                    "locality"   : "Bilbao",
                    "country"    : "Spain",
                    "id"         : "PLACE_ID",                            "created_at" : "Tue Feb 04 2014 13:49:42 GMT+0100 (CET)",
                    "position"   : [ -2.29, 23.23 ]
                },
            "assistents" : [],
            "created_at" : "Tue Feb 04 2014 13:49:42 GMT+0100 (CET)",
            "tags"       : ["futbol", "sport"],
            "owner":
              {
                  "id"       : "OWNER_ID",
                    "username" : "OWNER_NICKNAME",
                    "mail"     : "OWNER_MAIL",
                    "avatar"   : "http://appnima.com/img/avatar.jpg",
                    "name"     : "OWNER_NAME"
                }
      }
```

#### Update event

It also allows us to modify an event. You must send an object containing as parameters the "id" of the event to be modified, the event name, description, start and end dates in formarto mm-dd-yyyy hh:mm:, a string with a list of "id" separated "," corresponding to the users you want to share this event, a string with a list separated by "," address at which to hold the event tags, location, users the country, the latitude and longitude.

```coffeescript
  data =
    event       : EVENT_ID
    calendar    : CALENDAR_ID
    name        : "Partido de baloncesto"
    description : "Quedada para jugar un partido de baloncesto"
    init        : "04-14-2014 09:00"
    finish      : "04-14-2014 11:00"
    address     : "c/ San Mames"
    locality    : "Bilbao
    country     : "España"
    latitude    : "23.23"
    longitude   : "-2.29"
    guest       : null
    tags        : "futbol,deporte"
```

    Appnima.Calendar.updateEvent(data)

If the event does not exist, it returns a 404 error. If on the contrary exists, returns the event with the fields modified with the structure of the object that is returned in the create event.

#### List events

Through the following function can be obtained events calendars that the user owns, events calendars that have been shared, and the events to which you have been invited. Must filter events by time. If you want to list the events of a month, as the first parameter is sent "month", as the second parameter is sent the year, and the third parameter is the number of the month that you want to list the events.

  parameters =
    time  : "month",
    year  : "2014",
    month : "02"

  Appnima.Calendar.listEvents(parameters)

For list the events of a week, is sent as first "week" parameter, as second parameter the year of the week, as the third parameter the number of the month of week and day as the fourth parameter. This date corresponds to a day of the week you want to get the events:

  parameters =
    time  : "week",
    year  : "2014",
    month : "02",
    day   : "14"

  Appnima.Calendar.listEvents(parameteres)

For list the events of the day, is sent as the first parameter "day" parameter as the second year of day, as third parameter the number of the month and day as the fourth parameter.

  parameters =
    time  : "day",
    year  : "2014",
    month : "02",
    day   : "14"

  Appnima.Calendar.listEvents(parameters)

As  result is obtained a list of events :

```json
  "events":
    [
          {
                "id"          : "EVENT_ID",
                "calendar"    : "CALENDAR_ID",
                "date_init"   : "Sun Apr 20 2014 09:00:00 GMT+0200 (CEST)",
                "date_finish" : "Thu Mar 20 2014 11:00:00 GMT+0100 (CET)",
                "name"        : "Company dinner",
                "description" : "This event is company dinner",
                "place"       : "PLACE_ID",
                "assistents"  : [],
                "created_at"  : "Tue Feb 04 2014 14:39:04 GMT+0100 (CET)",
                "tags"        : [ "dinner", "enjoy" ],
                "owner":
                  {
                      "id"       : "OWNER_ID",
                      "username" : "OWNER_NICKNAME",
                      "mail"     : "OWNER_MAIL",
                      "avatar"   : "http://appnima.com/img/avatar.jpg",
                      "name"     : "OWNER_NAME"
                    }
          }
        ]
```

#### Invite to event.
Another feature that is possible, is to invite a user to an event, so that he too can see the event. Or on the contrary, remove an invitation to that user no longer see the event. To do this, simply run the following function shown below, sending as parameters, the "id" of the event, the "id" to invite the user, and "add" or "remove" if you want to add invitation , "add" is sent if instead you want to remove, is sent "remove".

  parameters =
    event   : "EVENT_ID",
    profile : "USER_ID",
    state   : "add"
  Appnima.Calendar.guestEvent(parameters)

If the event does not exist, it returns a 404 error. If on the contrary exists, returns the updated event. The "guest" attribute corresponds to the list of users that have been invited to the event.

```json
  "event":
        {
            "id"          : "EVENT_ID",
            "calendar"    : "CALENDAR_ID",
            "date_init"   : "Sun Apr 20 2014 09:00:00 GMT+0200 (CEST)",
            "date_finish" : "Thu Mar 20 2014 11:00:00 GMT+0100 (CET)",
            "name"        : "Company dinner",
            "description" : "This event is company dinner",
            "place"       : "PLACE_ID",
            "assistents"  : [],
            "guest"       : [ "USER_ID" ],
            "created_at"  : "Tue Feb 04 2014 14:39:04 GMT+0100 (CET)",
            "tags"        : [ "dinner", "enjoy" ],
            "owner":
              {
                  "id"       : "OWNER_ID",
                  "username" : "OWNER_NICKNAME",
                  "mail"     : "OWNER_MAIL",
                  "avatar"   : "http://appnima.com/img/avatar.jpg",
                  "name"     : "OWNER_NAME"
                }
        }
```
#### Assist to event.
To confirm your assistance at an event or to eliminate is used this function, in which is sent as parameter the "id" of the event, the "id" of the user, and "add" or "remove". If you want to confirm asistencia, "add", if instead you want to remove "remove".

  parameters =
    event : "EVENT_ID",
    state : "add"

  Appnima.Calendar.assistentEvent(parameters)

If the event does not exist, it returns a 404 error.  If on the contrary exists, return the updated event. The "assistents" attribute corresponds to the list of users who assist the event.


```json
  "event":
        {
            "id"          : "EVENT_ID",
            "calendar"    : "CALENDAR_ID",
            "date_init"   : "Sun Apr 20 2014 09:00:00 GMT+0200 (CEST)",
            "date_finish" : "Thu Mar 20 2014 11:00:00 GMT+0100 (CET)",
            "name"        : "Company dinner",
            "description" : "This event is company dinner",
            "place"       : "PLACE_ID",
            "assistents"  : ["USER_ID"],
            "guest"       : [ "USER_ID" ],
            "created_at"  : "Tue Feb 04 2014 14:39:04 GMT+0100 (CET)",
            "tags"        : [ "dinner", "enjoy" ],
            "owner":
              {
                  "id"       : "OWNER_ID",
                  "username" : "OWNER_NICKNAME",
                  "mail"     : "OWNER_MAIL",
                  "avatar"   : "http://appnima.com/img/avatar.jpg",
                  "name"     : "OWNER_NAME"
                }
        }
```

#### Search events
APP/NIMA allows you to search for events. The function sends a word as a parameter, and looks for a match with that word in the name and description of the events that you have access. That is, those who are on a calendar where you're the owner or have you shared and those events that you have been invited.

    Appnima.Calendar.search("meeting")

The function returns a list of events satisfying these matches:


```json
  "events":
    [
          {
                "id"          : "EVENT_ID",
                "calendar"    : "CALENDAR_ID",
                "date_init"   : "Sun Apr 20 2014 09:00:00 GMT+0200 (CEST)",
                "date_finish" : "Thu Mar 20 2014 11:00:00 GMT+0100 (CET)",
                "name"        : "Company dinner",
                "description" : "This event is company dinner",
                "place"       : "PLACE_ID",
                "assistents"  : [],
                "created_at"  : "Tue Feb 04 2014 14:39:04 GMT+0100 (CET)",
                "tags"        : [ "dinner", "enjoy" ],
                "owner":
                  {
                      "id"       : "OWNER_ID",
                      "username" : "OWNER_NICKNAME",
                      "mail"     : "OWNER_MAIL",
                      "avatar"   : "http://appnima.com/img/avatar.jpg",
                      "name"     : "OWNER_NAME"
                    }
          }
        ]
```


#### Delete event
It is possible to delete an event, you just have to run the following function, sending as parameter the "id" of the event:

  Appnima.Calendar.deleteEvent(EVENT_ID)

If the event does not exist, it returns a 404 error. If it goes well, it returns a success message.

  {message: Successful}

#### Actividad

As with a calendar, APP / NIMA also provides us with information on what has happened on a particular event. With the function below, sending as parameter the "id" of an event, provides a list of activities that have happened in it, such as: modify the event, invite someone or taking off of the guest list or corfirm assistance or delete  the corfirm assistance.

  Appnima.Calendar.activityEvent(EVENT_ID)

If the event does not exist, it returns a 404 error. If on the contrary exists, returns the updated event. The "guest" attribute corresponds to the list of users that have been invited to the event.

```json
  "activities":
    [
      {
        "id"         : "ACTIVITY_ID",
        "message"    : "Has invited the event to user",
        "created_at" : "Mon Feb 10 2014 16:56:25 GMT+0100 (CET)",
        "profile":
          {
            "username" : "USER_NICKNAME",
            "name"     : "USER_NAME",
            "mail"     : "USER_MAIL",
            "avatar"   : "http://appnima.com/img/avatar.jpg",
            "id"       : "USER_ID"
          },
        "event":
          {
            "id"          : "EVENT_ID",
            "calendar"    : "CALENDAR_ID",
            "date_init"   : "Mon Apr 14 2014 09:00:00 GMT+0200 (CEST)",
            "date_finish" : "Mon Apr 14 2014 11:00:00 GMT+0200 (CEST)",
            "name"        : "BilboStack updated",
            "description" : "This event is bilboStack",
            "place"       : "PLACE_ID",
            "assistents"  : [ "USER_ID" ],
            "created_at"  : "Mon Feb 10 2014 16:56:24 GMT+0100 (CET)",
            "tags"        : [ "learn" ],
            "guest"       : [ "USER_ID_1", "USER_ID_2" ]
           },
        "calendar":
          {
             "id"         : "CALENDAR_ID",
             "name"       : "Mi calendario updated",
             "color"      : "#FA58F4",
             "created_at" : "Mon Feb 10 2014 16:56:24 GMT+0100 (CET)",
             "owner"      : "OWNER_ID",
             "shared"     : []
           },
        "owner":
          {
            "id"       : "OWNER_ID",
            "username" : "OWNER_NICKNAME",
            "mail"     : "OWNER_MAIL",
            "avatar"   : "http://appnima.com/img/avatar.jpg",
            "name"     : "OWNER_NAME"
          }
      }
    ]
```

The event and the calendar is where the activity was performed. The field "owner" is the person performing the activity and the "profile" field is the person who is  targeted activity.


Socket
======
Groups
------
The groups are persistent rooms from 1 to N users. In the groups only allowed users can connect and send data. To work with groups an instance of group must be created:

    group = new Appnima.Socket.Group();

Create a group:

    group.create("name", ["2387569328yvc2","21y89ch3x8hg2032","2938tyh2g0ghh0i2bg8"]);

Get the groups I take part:

    group.list().then(function(error, groups){[code]});

Remove group:

    group.remove("id");

Change the name of the group:

    group.rename("id", "name");

Get the messages of the group. The second parameter is the page number, the first page is 0 and each page have 50 messages:

    group.messages("id", 0);

Delete unread messages count, the first parameter is the group id:

    group.deleteUnreadCount("id");

Chat
----
Chats are rooms from 1 to N users without persistence. In chats, as happens in the groups, only allowed users can connect and send data.To work with Chats first of all a instance of Chat must be created:

    chat = new Appnima.Socket.Chat();

Create a room:

    chat.create("name", ["2387569328yvc2","21y89ch3x8hg2032","2938tyh2g0ghh0i2bg8"]);


Emiter & Listener
-----------------
#### Emiter
The emiter is a room in which the autor of it is the only person allowed to send messages and the receivers must connect to it using `Appnima.Socket.Listener`. To create it the first thing is creating an instance of Emiter:

    room = new Appnima.Socket.Emiter();

Create a room:

    room.create("context");


#### Listener
The listener connects to rooms created with emiter and receives it messages. To create it the first thing is creating en instance and it will connect automatically to the room:

    listener = new Appnima.Socket.Listener("context");


Application
-----------
The application channel allows the users of an application to communicate with others. To connect to it just create an instance of the application:

    application = new Appnima.Socket.Application();


Inbox
-----
The inbox allows a user to receive messages from other users. The messages will only be received by the room author, but any user can send data.To do this create an instance of Inbox:

    inbox = new Appnima.Socket.Inbox();

Get the unread messages count by group:

    inbox.unreadCount(callback);

Get online friends:

    inbox.onOnlineFriends(callback);

Friend connection/disconnection:

    inbox.onFriendStatusChange(callback);

Send data to an user:

    inbox.sendToUser(user_id, data);


Methods
-------
This methods are the same for all the socket types seen previously:

* `instance.connect("id")`: Connect to a  Group or Chat

* `instance.disconnect()`: Disconnect from a room

* `instance.allowUSers(["","",""…])`: Add allowed users to Groups or Chats

* `instance.disallowUsers(["","",""…])`: Remove users from allewed list

* `instance.send(message)`: Send a message to all the users of a room, also the sender

* `instance.broadcast(message)`: Send a message to all the users of a room, except the sender

* `instance.onConnect(callback)`: Calls to the callback on room connection

* `instance.onError(callback)`: Calls to the callback on error

* `instance.onDisconnect(callback)`: Calls to the callback when the socket disconnect

* `instance.onMessage(callback)`: Calls to the callback on message received, the recived message will be an object like this:
    * content:  "message content"
    * user: {"Information about the sender"}
    * created_at: "2013-11-16T05:55:02.736Z"

* `instance.onDisallow(callback)`: Calls to the callback when a user is disallowed from the group


Payments
========
To make purchases in a simple way Appnima provides you with the Payment functionality. With appnima you can make in app purchasing easy with AppnimaJS methods. You can choose between 3 types of purchases:

1.  Free purchases
2.  Purchases with credit cards (through Stripe)
3.  Purchases with Paypal


CreditCards
-----------

To make payments posible Appnima stores your CreditCards information in a secure way so you dont have to send the credit card information any time you want to purchase something.

### Create a Credit Card
To create a new credit card you only have to send credit card info with a valid session. Calling createCreditCard will attach a new credit card to a users profile only if it is not previously created.The cvc is an optional parameter.

  parameters =
    number          : CREDIT_CARD_NUMBER
    cvc             : CREDIT_CARD_CVC
    expiration_date : CREDIT_CARD_EXPIRATION_DATE

  Appnima.Payments.createCreditCard(parameters)

If the process ends correctly you mus receive this information:

```json
{
  "id"     : "CREDIT_CARD_ID",
  "number" : "xxxxxxxxxxxx4242"
}
```

You can also add an alias parameter to the appnima request to identify better your cards.

  parameters =
    number          : CREDIT_CARD_NUMBER
    cvc             : CREDIT_CARD_CVC
    expiration_date : CREDIT_CARD_EXPIRATION_DATE
    alias           : CREDIT_CARD_ALIAS

    Appnima.Payments.createCreditCard(parameters)

### Check a user Credit Cards
To see all the credit cards a user has attached to his account you only have to call getCreditCards method.

    Appnima.Payments.getCreditCards()

It will return us an array with all the credit cards information.

### Delete a Credit Card
For security reasons to delete a credit card you must do it with the ID of the credit card. Send the id through the method deleteCreditCard and the CreditCard will be erased.

    Appnima.Payments.deleteCreditCard({id: "CREDIT_CARD_ID"})

If all goes right Appnima will return a code 200 Succesfull message.

### Modify a Credit Card
For same security reasons to update a credit card you must do it with the ID of the credit card. Send the id  and the parameters you want to change through the method updateCreditCard and the CreditCard information will be updated.

  paramters =
    id     : CREDIT_CARD_ID
    number : CREDIT_CARD_NUMBER

  Appnima.Payments.updateCreditCard(parameters)

Once again If all goes right Appnima will return a code 200 Succesfull message.

Purchases
---------
To make purchases through appnima you can do it in 3 different ways,free purchases, purchases using credit cards as payment method through Stripe and purchases with PayPal.

To choose between this 3 options you only have to change the provider parameter. To make free purchases you have to omit the provider parameter, just dont send it. To choose Stripe you must send provider:0 and to choose PayPal you should choose provider:1.


### Create a free purchase

To make purchases that doesnt need money you can create free purchase just calling:

    Appnima.Payments.purchase();

If all goes right Appnima will send us a unique purchase token and the amount of the purchase.

```json
{
  "token"  : "PURCHASE_SECRET_TOKEN",
  "amount" : 0
}
```

If you want you can add a reference object with the structure you want encoded into a string chain with JSON.stringify. It must be a valid JSON.

  Appnima.Payments.purchase({reference: '{ "id":"example id", "content": "example content"}'})

### Confirm a purchase

When we receive the token and amount from appnima it means that the purchase is pending of confirmation. You must confirm it with the same parameters you have received.

    Appnima.Payments.confirm({token: "purchase_secret_token", amount: 0});

If all goes right Appnima will send us the purchase information back with state set to 3.

```json
{
  "id"       : "PURCHASE_ID",
  "payed_at" : "PURCHASE_CONFIRMATION_DATE",
  "state"    : "PURCHASE_STATE" "
}
```

### Make a stripe purchase

To make a purchase through stripe you should send provider parameter set to 0, and the credit card id with the cvc. Remember the amount currency is in EUR.

    Appnima.Payments.purchase({
        provider    : 0,
        credit_card : CREDIT_CARD_ID,
        cvc         : 123,
        amount      : 120,
        reference   : '{ "id_stripe":"id stripe", "test_content": "stripe content", "number": 6161 }'
        });

If the purchase was successfuly created App/nima returns:

```json
{
  "token"  : "PURCHASE_SECRET_TOKEN",
  "amount" : 120
}
```

### Confirm a Stripe purchase
To confirm a stripe purchasing you must send provider parameter set to 0, purchase token and the amount.

  Appnima.Payments.confirm({provider:0, token: "purchase_secret_token", amount: 0});

If the purchase was successfuly confirmed App/nima returns:

```json
{
  "id"       : "PURCHASE_ID",
  "payed_at" : "PURCHASE_CONFIRMATION_DATE",
  "state"    : "PURCHASE_STATE"
}
```

### Generate a PayPal purchase
To create a paypal purchase you only have to set the provider parameter set to 1 and the amount needed, If you include the reference object with a description, description value will be shown in the Paypal gateway as purchase information.

    Appnima.Payments.purchase({
        provider          : 1,
        amount            : 120,
        reference         : '{ "id_stripe":"id paypal", "description": "boat: 10000€", "number": 6161 }'
        });
